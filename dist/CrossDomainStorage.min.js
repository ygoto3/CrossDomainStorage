!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),(n.index||(n.index={})).js=e()}}(function(){return function e(n,t,o){function r(a,s){if(!t[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=t[a]={exports:{}};n[a][0].call(c.exports,function(e){var t=n[a][1][e];return r(t?t:e)},c,c.exports,e,n,t,o)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,n,t){"use strict";function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=e("./storage.js"),a="CrossDomainStorage",s=function(){function e(n,t){o(this,e),this.name=n,t?this.createIframeWindow(t):this.setupParentWindow(),this.listen()}return r(e,[{key:"setupParentWindow",value:function(){var e=this;new Promise(function(n,t){e.targetWindow=window.parent,n(e)})}},{key:"createIframeWindow",value:function(e){var n=this,t=document.createElement("IFRAME");t.name=this.name,t.src=e,t.width=0,t.height=0,t.style.display="none",t.style.visibility="hidden";var o=document.body,r=new Promise(function(e,r){o.appendChild(t),t.addEventListener("load",function(){n.targetWindow=t.contentWindow,e(n)})});this.ready=r}},{key:"listen",value:function(){var e=this;return window.addEventListener("message",function(n){var t=n.data,o=t.event,r={event:o+":done",status:"success"};switch(o){case a+":get":r.data=i.getFromStorage();break;case a+":save":i.setToStorage(t.data);break;case a+":remove":i.removeFromStorage(t.key)}e.targetWindow.postMessage(r,"*")},!1),this}},{key:"get",value:function(e){return this.getAll().then(function(n){return n[e]})}},{key:"getAll",value:function(){var e=this;return new Promise(function(n,t){window.addEventListener("message",function(e){var t=e.data,o=t.event;o===a+":get:done"&&"success"===t.status&&n(t.data)}),e.ready.then(function(e){e.targetWindow.postMessage({event:a+":get"},"*")})})}},{key:"save",value:function(e,n){var t={};return t[e]=n,this.saveObject(t)}},{key:"saveObject",value:function(e){var n=this;return new Promise(function(t,o){window.addEventListener("message",function(e){var n=e.data,o=n.event;o===a+":save:done"&&"success"===n.status&&t()}),n.ready.then(function(n){n.targetWindow.postMessage({event:a+":save",data:e},"*")})})}},{key:"delete",value:function(e){var n=this;return new Promise(function(t,o){window.addEventListener("message",function(e){var n=e.data,o=n.event;o===a+":remove:done"&&"success"===n.status&&t()}),n.ready.then(function(n){n.targetWindow.postMessage({event:a+":remove",key:e},"*")})})}}]),e}();n.exports=s},{"./storage.js":3}],2:[function(e,n,t){"use strict";var o=e("./Channel.js"),r={channels:{},newChannel:function(e,n){var t=new o(e,n);return this.channels[e]=t,t},getChannel:function(e){return this.channels[e]}};n.exports=r},{"./Channel.js":1}],3:[function(e,n,t){"use strict";var o="undefined"==typeof window.chrome&&"WebkitAppearance"in document.documentElement.style,r="CrossDomainStorage",i="Fri, 31 Dec 9999 23:59:59 GMT";n.exports={getFromStorage:function(){var e;return(e=o?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(r).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:window.localStorage.getItem(r))?JSON.parse(e):void 0},setToStorage:function(e){var n=this.getFromStorage(r);n||(n={});for(var t in e)n[t]=e[t];o?window.document.cookie=r+"="+JSON.stringify(n):window.localStorage.setItem(r,JSON.stringify(n))},removeFromStorage:function(e){var n=this.getFromStorage(r);if(n&&n[e]){delete n[e];var t=JSON.stringify(n);"{}"===t?o?window.document.cookie=r+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC":window.localStorage.removeItem(r):o?window.document.cookie=r+"="+t+"; expires="+i:window.localStorage.setItem(r,t)}}}},{}]},{},[2])(2)});